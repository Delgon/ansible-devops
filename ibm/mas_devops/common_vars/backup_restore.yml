---
# Common variables
# -----------------------------------------------------------------------------
# Whether to confirm the currently connected cluster before run tasks
masbr_confirm_cluster: "{{ lookup('env', 'MASBR_CONFIRM_CLUSTER') | default(true, true) | bool }}"

# Copy file timeout in seconds
masbr_copy_timeout_sec: "{{ lookup('env', 'MASBR_COPY_TIMEOUT_SEC') | default(3600, true) | int }}"

# Whether to allow multiple backup/restore jobs to run simultaneously
# (Should only set it to true for debugging, normally not allow running multiple backup/retore jobs simultaneously)
masbr_allow_multi_jobs: "{{ lookup('env', 'MASBR_ALLOW_MULTI_JOBS') | default(false, true) | bool }}"


# Storage variables
# -----------------------------------------------------------------------------
# Local temp folder for backup/restore
masbr_local_temp_folder: "{{ lookup('env', 'MASBR_LOCAL_TEMP_FOLDER') | default('/tmp/masbr', true) }}"

# <Required>
masbr_storage_type: "{{ lookup('env', 'MASBR_STORAGE_TYPE') }}"

# <Required> when masbr_storage_type='local'
masbr_storage_local_folder: "{{ lookup('env', 'MASBR_STORAGE_LOCAL_FOLDER') }}"

# <Required> when masbr_storage_type='pvc'
masbr_storage_pvc_name: "{{ lookup('env', 'MASBR_STORAGE_PVC_NAME') }}"
masbr_storage_pvc_path: "{{ lookup('env', 'MASBR_STORAGE_PVC_PATH') | default('masbr', true) }}"

# <Required> when masbr_storage_type='cloud'
masbr_storage_cloud_rclone_file: "{{ lookup('env', 'MASBR_STORAGE_CLOUD_RCLONE_FILE') }}"
masbr_storage_cloud_rclone_name: "{{ lookup('env', 'MASBR_STORAGE_CLOUD_RCLONE_NAME') }}"
masbr_storage_cloud_bucket: "{{ lookup('env', 'MASBR_STORAGE_CLOUD_BUCKET') }}"


# Backup variables
# -----------------------------------------------------------------------------
# Supported backup types: 'full' and 'incr'
masbr_backup_type: "{{ lookup('env', 'MASBR_BACKUP_TYPE') | default('full', true) }}"

# The name of the backup to create incremental backup based on
# <Required> when masbr_backup_type='incr'
masbr_backup_from: "{{ lookup('env', 'MASBR_BACKUP_FROM') | default('', true) }}"

# Cron expression for scheduled backup
# https://en.wikipedia.org/wiki/Cron
masbr_backup_schedule: "{{ lookup('env', 'MASBR_BACKUP_SCHEDULE') | default('', true) }}"

# Time zone for scheduled backup
# https://en.wikipedia.org/wiki/List_of_tz_database_time_zones
masbr_backup_timezone: "{{ lookup('env', 'MASBR_BACKUP_TIMEZONE') | default('', true) }}"


# Restore variables
# -----------------------------------------------------------------------------
# The name of the backup to be restored from
# <Required>
masbr_restore_from: "{{ lookup('env', 'MASBR_RESTORE_FROM') }}"


# Notification variables
# -----------------------------------------------------------------------------
# Supported notification levels:
#   - 'info': send notifications when job in the phase 'InProgress', 'Completed', 'Failed', 'PartiallyFailed'
#   - 'failure': sent notifications only when job in the phase 'Failed', 'PartiallyFailed'
masbr_notification_levels:
  info:
    - "InProgress"
    - "Completed"
    - "Failed"
    - "PartiallyFailed"
  failure:
    - "Failed"
    - "PartiallyFailed"

# Slack notification
masbr_slack_enabled: "{{ lookup('env', 'MASBR_SLACK_ENABLED') | default(false, true) | bool }}"
masbr_slack_level: "{{ lookup('env', 'MASBR_SLACK_LEVEL') | default('info', true) }}"
masbr_slack_token: "{{ lookup('env', 'MASBR_SLACK_TOKEN') }}"
masbr_slack_channel: "{{ lookup('env', 'MASBR_SLACK_CHANNEL') }}"
masbr_slack_user: "{{ lookup('env', 'MASBR_SLACK_USER') | default('ansible', true) }}"
