<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://ibm-mas.github.io/ansible-devops/roles/db2/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>db2 - MAS Devops Collection</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "db2";
        var mkdocs_page_input_path = "roles/db2.md";
        var mkdocs_page_url = "/ansible-devops/roles/db2/";
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> MAS Devops Collection
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../changes/">Changes</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Playbooks</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/ocp/">OCP</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/oneclick-core/">Install Core</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/oneclick-iot/">Add IoT</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/oneclick-manage/">Add Manage</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/oneclick-monitor/">Add Monitor</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/oneclick-optimizer/">Add Optimizer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/oneclick-predict/">Add Predict</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/oneclick-update/">Update</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/oneclick-upgrade/">Upgrade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/oneclick-visualinspection/">Add Visual Inspection</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Roles: OCP Mgmt</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_deprovision/">ocp_deprovision</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_disable_updates/">ocp_disable_updates</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_github_oauth/">ocp_github_oauth</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_login/">ocp_login</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_provision/">ocp_provision</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_roks_upgrade_registry_storage/">ocp_roks_upgrade_registry_storage</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_upgrade/">ocp_upgrade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_verify/">ocp_verify</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Roles: Dependency Mgmt</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../appconnect/">appconnect</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../aws_bucket_access_point/">aws_bucket_access_point</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../aws_policy/">aws_policy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../aws_user_creation/">aws_user_creation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../aws_vpc/">aws_vpc</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cert_manager/">cert_manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cert_manager_upgrade/">cert_manager_upgrade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cert_manager_upgrade_check/">cert_manager_upgrade_check</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cluster_monitoring/">cluster_monitoring</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cis/">cis</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cos/">cos</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cos_bucket/">cos_bucket</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cp4d_admin_pwd_update/">cp4d_admin_pwd_update</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cp4d_hack_worker_nodes/">cp4d_hack_worker_nodes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cp4d/">cp4d</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cp4d_service/">cp4d_service</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cp4d_upgrade/">cp4d_upgrade</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">db2</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#role-variables-installation">Role Variables - Installation</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#db2_instance_name">db2_instance_name</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#ibm_entitlement_key">ibm_entitlement_key</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_entitlement_key">db2_entitlement_key</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_dbname">db2_dbname</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_version">db2_version</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_4k_device_support">db2_4k_device_support</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_workload">db2_workload</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_table_org">db2_table_org</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_ldap_username">db2_ldap_username</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_ldap_password">db2_ldap_password</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#role-variables-storage">Role Variables - Storage</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#db2_meta_storage_class">db2_meta_storage_class</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_meta_storage_size">db2_meta_storage_size</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_meta_storage_accessmode">db2_meta_storage_accessmode</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_data_storage_class">db2_data_storage_class</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_data_storage_size">db2_data_storage_size</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_data_storage_accessmode">db2_data_storage_accessmode</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_backup_storage_class">db2_backup_storage_class</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_backup_storage_size">db2_backup_storage_size</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_backup_storage_accessmode">db2_backup_storage_accessmode</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_logs_storage_class">db2_logs_storage_class</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_logs_storage_size">db2_logs_storage_size</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_logs_storage_accessmode">db2_logs_storage_accessmode</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_temp_storage_class">db2_temp_storage_class</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_temp_storage_size">db2_temp_storage_size</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_temp_storage_accessmode">db2_temp_storage_accessmode</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#role-variables-resource-requests">Role Variables - Resource Requests</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#db2_cpu_requests">db2_cpu_requests</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_cpu_limits">db2_cpu_limits</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_memory_requests">db2_memory_requests</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_memory_limits">db2_memory_limits</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#role-variables-node-affinity">Role Variables - Node Affinity</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#db2_node_label">db2_node_label</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_dedicated_node">db2_dedicated_node</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#custom_labels">custom_labels</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#role-variables-db2ucluster-database-configuration-settings">Role Variables - DB2UCluster Database Configuration Settings</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#db2_database_db_config">db2_database_db_config:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_instance_dbm_config">db2_instance_dbm_config:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_instance_registry">db2_instance_registry:</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#role-variables-mpp-system">Role Variables - MPP System</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#db2_mln_count">db2_mln_count</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2_num_pods">db2_num_pods</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#role-variables-mas-configuration">Role Variables - MAS Configuration</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#mas_instance_id">mas_instance_id</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mas_config_dir">mas_config_dir</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mas_config_scope">mas_config_scope</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mas_workspace_id">mas_workspace_id</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mas_application_id">mas_application_id</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#example-playbook">Example Playbook</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#license">License</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../db2_backup/">db2_backup</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../db2_restore/">db2_restore</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../kafka/">kafka</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../nvidia_gpu/">nvidia_gpu</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mongodb/">mongodb</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocs/">ocs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../sbo/">sbo</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../sbo_upgrade/">sbo_upgrade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../sls/">sls</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../uds/">uds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Roles: Image Mirroring</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../mirror_case_prepare/">mirror_case_prepare</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mirror_extras_prepare/">mirror_extras_prepare</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mirror_images/">mirror_images</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mirror_ocp_release/">mirror_ocp_release</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_contentsourcepolicy/">ocp_contentsourcepolicy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_simulate_disconnected_network/">ocp_simulate_disconnected_network</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../registry/">registry</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Roles: Suite Mgmt</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_app_config/">suite_app_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_app_install/">suite_app_install</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_app_upgrade/">suite_app_upgrade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_config/">suite_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_db2_setup_for_manage/">suite_db2_setup_for_manage</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_dns/">suite_dns</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_install/">suite_install</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_install_digest_cm/">suite_install_digest_cm</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_manage_attachments_config/">suite_manage_attachments_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_manage_bim_config/">suite_manage_bim_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_manage_doclinks_config/">suite_manage_doclinks_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_manage_import_certs_config/">suite_manage_import_certs_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_manage_load_dbc_scripts/">suite_manage_load_dbc_scripts</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_manage_logging_config/">suite_manage_logging_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_manage_pvc_config/">suite_manage_pvc_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_mustgather/">suite_mustgather</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_mustgather_download/">suite_mustgather_download</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_switch_to_olm/">suite_switch_to_olm</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_upgrade/">suite_upgrade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_verify/">suite_verify</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Roles: Utilities</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ansible_version_check/">ansible_version_check</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gencfg_jdbc/">gencfg_jdbc</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gencfg_watsonstudio/">gencfg_watsonstudio</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gencfg_workspace/">gencfg_workspace</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../install_operator/">install_operator</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">MAS Devops Collection</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Roles: Dependency Mgmt &raquo;</li>
      <li>db2</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/ibm-mas/ansible-devops/blob/master/docs/roles/db2.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="db2">db2<a class="headerlink" href="#db2" title="Permanent link"></a></h1>
<p>This role creates a Db2 Warehouse instance using the Db2u Operator. A namespace called <code>db2u</code> will be created and the db2u operator will be installed into the <code>ibm-common-services</code> namespace to service the <code>db2ucluster</code> requests in <code>db2u</code> namespace. A private root CA certificate is created and is used to secure the TLS connections to the database. A Db2 Warehouse cluster will be created along with a public TLS encrypted route to allow external access to the cluster (access is via the ssl-server nodeport port on the <em>-db2u-engn-svc service). Internal access is via the </em>-db2u-engn-svc service and port 50001. Both the external route and the internal service use the same server certificate.</p>
<p>The private root CA certificate and the server certificate are available from the <code>db2u-ca</code> and <code>db2u-certificate</code> secrets in the <code>db2u</code> namespace.  The default user is <code>db2inst1</code> and the password is available in the <code>instancepassword</code> secret in the same namespace.  You can examine the deployed resources in the <code>db2u</code> namespace:</p>
<pre><code class="language-bash">oc -n db2u get db2ucluster

NAME        STATE   MAINTENANCESTATE   AGE
db2u-db01   Ready   None               29m
</code></pre>
<p>It typically takes 20-30 minutes from the db2ucluster being created till it is ready. If the db2ucluster is not ready after that period then check that all the PersistentVolumeClaims in the <code>db2u</code> namespace are ready and that the pods in the namespace are not stuck in init state. If the <code>c-&lt;db2_instance_name&gt;-db2u-0</code> pod is running then you can exec into the pod and check the <code>/var/log/db2u.log</code> for any issue.</p>
<p>If the <code>db2_node_label</code> and <code>db2_dedicated_node</code> variables are defined then role will taint and drain the dedicated node before labeling it using <code>database={{ db2_node_label }}</code>. The node is then uncordoned.</p>
<p>If the <code>mas_instance_id</code> and <code>mas_config_dir</code> are provided then the role will generate the JdbcCfg yaml that can be used to configure MAS to connect to this database. It does not apply the yaml to the cluster but does provide you with the yaml files to apply if needed.</p>
<h2 id="role-variables-installation">Role Variables - Installation<a class="headerlink" href="#role-variables-installation" title="Permanent link"></a></h2>
<h3 id="db2_instance_name">db2_instance_name<a class="headerlink" href="#db2_instance_name" title="Permanent link"></a></h3>
<p>Name of the database instance, note that this is the instance <strong>name</strong>.</p>
<ul>
<li><strong>Required</strong></li>
<li>Environment Variable: <code>DB2_INSTANCE_NAME</code></li>
<li>Default: None</li>
</ul>
<h3 id="ibm_entitlement_key">ibm_entitlement_key<a class="headerlink" href="#ibm_entitlement_key" title="Permanent link"></a></h3>
<p>Provide your <a href="https://myibm.ibm.com/products-services/containerlibrary">IBM entitlement key</a>.</p>
<ul>
<li><strong>Required</strong></li>
<li>Environment Variable: <code>IBM_ENTITLEMENT_KEY</code></li>
<li>Default: None</li>
</ul>
<h3 id="db2_entitlement_key">db2_entitlement_key<a class="headerlink" href="#db2_entitlement_key" title="Permanent link"></a></h3>
<p>An IBM entitlement key specific for Db2 installation, primarily used to override <code>ibm_entitlement_key</code> in development.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_ENTITLEMENT_KEY</code></li>
<li>Default: None</li>
</ul>
<h3 id="db2_dbname">db2_dbname<a class="headerlink" href="#db2_dbname" title="Permanent link"></a></h3>
<p>Name of the database within the instance.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_DBNAME</code></li>
<li>Default: <code>BLUDB</code></li>
</ul>
<h3 id="db2_version">db2_version<a class="headerlink" href="#db2_version" title="Permanent link"></a></h3>
<p>Version of the DB2U operator instance to be created.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_VERSION</code></li>
<li>Default: <code>11.5.7.0-cn2</code></li>
</ul>
<h3 id="db2_4k_device_support">db2_4k_device_support<a class="headerlink" href="#db2_4k_device_support" title="Permanent link"></a></h3>
<p>Whether 4K device support is turned on or not.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_4K_DEVICE_SUPPORT</code></li>
<li>Default: <code>ON</code></li>
</ul>
<h3 id="db2_workload">db2_workload<a class="headerlink" href="#db2_workload" title="Permanent link"></a></h3>
<p>The workload profile of the db2 instance, possible values are <code>PUREDATA_OLAP</code> or <code>ANALYTICS</code>.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_WORKLOAD</code></li>
<li>Default: <code>ANALYTICS</code></li>
</ul>
<h3 id="db2_table_org">db2_table_org<a class="headerlink" href="#db2_table_org" title="Permanent link"></a></h3>
<p>The way database tables will be organized. It can be set to either <code>ROW</code> or <code>COLUMN</code>.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_TABLE_ORG</code></li>
<li>Default: <code>ROW</code></li>
</ul>
<h3 id="db2_ldap_username">db2_ldap_username<a class="headerlink" href="#db2_ldap_username" title="Permanent link"></a></h3>
<p>Define the username of db2 in the local LDAP registry. If this is defined, the LDAP user will be the user identity passed into the MAS JDBC configuration.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_LDAP_USERNAME</code></li>
<li>Default: None</li>
</ul>
<h3 id="db2_ldap_password">db2_ldap_password<a class="headerlink" href="#db2_ldap_password" title="Permanent link"></a></h3>
<p>Define the password of above db2 user in the local LDAP registry. Must define when <code>db2_ldap_username</code> is defined.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_LDAP_PASSWORD</code></li>
<li>Default: None</li>
</ul>
<h2 id="role-variables-storage">Role Variables - Storage<a class="headerlink" href="#role-variables-storage" title="Permanent link"></a></h2>
<h3 id="db2_meta_storage_class">db2_meta_storage_class<a class="headerlink" href="#db2_meta_storage_class" title="Permanent link"></a></h3>
<p>Storage class used for metadata. This must support ReadWriteMany</p>
<ul>
<li><strong>Required</strong></li>
<li>Environment Variable: <code>DB2_META_STORAGE_CLASS</code></li>
<li>Default: Defaults to <code>ibmc-file-gold</code> if the storage class is available in the cluster.</li>
</ul>
<h3 id="db2_meta_storage_size">db2_meta_storage_size<a class="headerlink" href="#db2_meta_storage_size" title="Permanent link"></a></h3>
<p>Size of the metadata persistent volume, in gigabytes</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_META_STORAGE_SIZE</code></li>
<li>Default: <code>20Gi</code></li>
</ul>
<h3 id="db2_meta_storage_accessmode">db2_meta_storage_accessmode<a class="headerlink" href="#db2_meta_storage_accessmode" title="Permanent link"></a></h3>
<p>The access mode for the storage.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_META_STORAGE_ACCESSMODE</code></li>
<li>Default: <code>ReadWriteMany</code></li>
</ul>
<h3 id="db2_data_storage_class">db2_data_storage_class<a class="headerlink" href="#db2_data_storage_class" title="Permanent link"></a></h3>
<p>Storage class used for user data. This must support ReadWriteOnce</p>
<ul>
<li><strong>Required</strong></li>
<li>Environment Variable: <code>DB2_DATA_STORAGE_CLASS</code></li>
<li>Default: Defaults to <code>ibmc-block-gold</code> if the storage class is available in the cluster.</li>
</ul>
<h3 id="db2_data_storage_size">db2_data_storage_size<a class="headerlink" href="#db2_data_storage_size" title="Permanent link"></a></h3>
<p>Size of data persistent volume.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_DATA_STORAGE_SIZE</code></li>
<li>Default: <code>100Gi</code></li>
</ul>
<h3 id="db2_data_storage_accessmode">db2_data_storage_accessmode<a class="headerlink" href="#db2_data_storage_accessmode" title="Permanent link"></a></h3>
<p>The access mode for the storage.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_DATA_STORAGE_ACCESSMODE</code></li>
<li>Default: <code>ReadWriteOnce</code></li>
</ul>
<h3 id="db2_backup_storage_class">db2_backup_storage_class<a class="headerlink" href="#db2_backup_storage_class" title="Permanent link"></a></h3>
<p>Storage class used for backup. This must support ReadWriteMany</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_BACKUP_STORAGE_CLASS</code></li>
<li>Default: Defaults to <code>ibmc-file-gold</code> if the storage class is available in the cluster.</li>
</ul>
<h3 id="db2_backup_storage_size">db2_backup_storage_size<a class="headerlink" href="#db2_backup_storage_size" title="Permanent link"></a></h3>
<p>Size of backup persistent volume.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_BACKUP_STORAGE_SIZE</code></li>
<li>Default: <code>100Gi</code></li>
</ul>
<h3 id="db2_backup_storage_accessmode">db2_backup_storage_accessmode<a class="headerlink" href="#db2_backup_storage_accessmode" title="Permanent link"></a></h3>
<p>The access mode for the storage.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_BACKUP_STORAGE_ACCESSMODE</code></li>
<li>Default: <code>ReadWriteMany</code></li>
</ul>
<h3 id="db2_logs_storage_class">db2_logs_storage_class<a class="headerlink" href="#db2_logs_storage_class" title="Permanent link"></a></h3>
<p>Storage class used for transaction logs. This must support ReadWriteOnce</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_LOGS_STORAGE_CLASS</code></li>
<li>Default: Defaults to <code>ibmc-block-gold</code> if the storage class is available in the cluster.</li>
</ul>
<h3 id="db2_logs_storage_size">db2_logs_storage_size<a class="headerlink" href="#db2_logs_storage_size" title="Permanent link"></a></h3>
<p>Size of transaction logs persistent volume.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_LOGS_STORAGE_SIZE</code></li>
<li>Default: <code>100Gi</code></li>
</ul>
<h3 id="db2_logs_storage_accessmode">db2_logs_storage_accessmode<a class="headerlink" href="#db2_logs_storage_accessmode" title="Permanent link"></a></h3>
<p>The access mode for the storage.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_LOGS_STORAGE_ACCESSMODE</code></li>
<li>Default: <code>ReadWriteOnce</code></li>
</ul>
<h3 id="db2_temp_storage_class">db2_temp_storage_class<a class="headerlink" href="#db2_temp_storage_class" title="Permanent link"></a></h3>
<p>Storage class used for temporary data. This must support ReadWriteOnce</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_TEMP_STORAGE_CLASS</code></li>
<li>Default: Defaults to <code>ibmc-block-gold</code> if the storage class is available in the cluster.</li>
</ul>
<h3 id="db2_temp_storage_size">db2_temp_storage_size<a class="headerlink" href="#db2_temp_storage_size" title="Permanent link"></a></h3>
<p>Size of temporary persistent volume.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_TEMP_STORAGE_SIZE</code></li>
<li>Default: <code>100Gi</code></li>
</ul>
<h3 id="db2_temp_storage_accessmode">db2_temp_storage_accessmode<a class="headerlink" href="#db2_temp_storage_accessmode" title="Permanent link"></a></h3>
<p>The access mode for the storage.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_TEMP_STORAGE_ACCESSMODE</code></li>
<li>Default: <code>ReadWriteOnce</code></li>
</ul>
<h2 id="role-variables-resource-requests">Role Variables - Resource Requests<a class="headerlink" href="#role-variables-resource-requests" title="Permanent link"></a></h2>
<h3 id="db2_cpu_requests">db2_cpu_requests<a class="headerlink" href="#db2_cpu_requests" title="Permanent link"></a></h3>
<p>Define the Kubernetes CPU request for the Db2 pod.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_CPU_REQUESTS</code></li>
<li>Default: <code>4000m</code></li>
</ul>
<h3 id="db2_cpu_limits">db2_cpu_limits<a class="headerlink" href="#db2_cpu_limits" title="Permanent link"></a></h3>
<p>Define the Kubernetes CPU limit for the Db2 pod.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_CPU_LIMITS</code></li>
<li>Default: <code>6000m</code></li>
</ul>
<h3 id="db2_memory_requests">db2_memory_requests<a class="headerlink" href="#db2_memory_requests" title="Permanent link"></a></h3>
<p>Define the Kubernetes memory request for the Db2 pod.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_MEMORY_REQUESTS</code></li>
<li>Default: <code>8Gi</code></li>
</ul>
<h3 id="db2_memory_limits">db2_memory_limits<a class="headerlink" href="#db2_memory_limits" title="Permanent link"></a></h3>
<p>Define the Kubernetes memory limit for the Db2 pod.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DB2_MEMORY_LIMITS</code></li>
<li>Default: <code>12Gi</code></li>
</ul>
<h2 id="role-variables-node-affinity">Role Variables - Node Affinity<a class="headerlink" href="#role-variables-node-affinity" title="Permanent link"></a></h2>
<h3 id="db2_node_label">db2_node_label<a class="headerlink" href="#db2_node_label" title="Permanent link"></a></h3>
<p>The label used to specify node affinity and tolerations in the db2ucluster CR.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>'DB2_NODE_LABEL</code></li>
<li>Default: None</li>
</ul>
<h3 id="db2_dedicated_node">db2_dedicated_node<a class="headerlink" href="#db2_dedicated_node" title="Permanent link"></a></h3>
<p>The name of the worker node to apply the <code>{{ db2_node_label }}</code> taint and label to.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>'DB2_DEDICATED_NODE</code></li>
<li>Default: None</li>
</ul>
<h3 id="custom_labels">custom_labels<a class="headerlink" href="#custom_labels" title="Permanent link"></a></h3>
<p>List of comma separated key=value pairs for setting custom labels on instance specific resources.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>CUSTOM_LABELS</code></li>
<li>Default Value: None</li>
</ul>
<h2 id="role-variables-db2ucluster-database-configuration-settings">Role Variables - DB2UCluster Database Configuration Settings<a class="headerlink" href="#role-variables-db2ucluster-database-configuration-settings" title="Permanent link"></a></h2>
<p>The following variables will overwrite DB2UCluster default properties for the DB2 configuration sections:</p>
<ul>
<li>spec.environment.database.dbConfig</li>
<li>spec.environment.instance.dbmConfig</li>
<li>spec.environment.instance.registry</li>
</ul>
<pre><code>dbConfig:
  APPLHEAPSZ: 8192 AUTOMATIC # Recommended heap memory size: https://www.ibm.com/docs/en/mas83/8.3.0?topic=dependencies-configure-database-health
dbmConfig:
  INSTANCE_MEMORY: AUTOMATIC
registry:
  DB2AUTH: 'OSAUTHDB,ALLOW_LOCAL_FALLBACK,PLUGIN_AUTO_RELOAD'
  DB2_4K_DEVICE_SUPPORT: '{{ db2_4k_device_support }}'
  DB2_FMP_RUN_AS_CONNECTED_USER: 'NO'
  DB2_WORKLOAD: '{{ db2_workload }}'
</code></pre>
<h3 id="db2_database_db_config">db2_database_db_config:<a class="headerlink" href="#db2_database_db_config" title="Permanent link"></a></h3>
<p>Overwrites the db2ucluster database configuration settings under <code>spec.environment.database.dbConfig</code> section.
You can define parameters to be included in this section using semicolon separated values.</p>
<p>Example: <code>export DB2_DATABASE_DB_CONFIG='APPLHEAPSZ=8192 AUTOMATIC'</code></p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>'DB2_DATABASE_DB_CONFIG'</code></li>
<li>Default: None</li>
</ul>
<h3 id="db2_instance_dbm_config">db2_instance_dbm_config:<a class="headerlink" href="#db2_instance_dbm_config" title="Permanent link"></a></h3>
<p>Overwrites the db2ucluster instance database configuration settings under <code>spec.environment.instance.dbmConfig</code> section.
You can define parameters to be included in this section using semicolon separated values.</p>
<p>Example: <code>export DB2_INSTANCE_DBM_CONFIG='INSTANCE_MEMORY=AUTOMATIC'</code></p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>'DB2_INSTANCE_DBM_CONFIG'</code></li>
<li>Default: None</li>
</ul>
<h3 id="db2_instance_registry">db2_instance_registry:<a class="headerlink" href="#db2_instance_registry" title="Permanent link"></a></h3>
<p>Overwrites the db2ucluster instance database configuration settings under <code>spec.environment.instance.registry</code> section.
You can define parameters to be included in this section using semicolon separated values.</p>
<p>Example: <code>export DB2_INSTANCE_REGISTRY='DB2AUTH=OSAUTHDB,ALLOW_LOCAL_FALLBACK,PLUGIN_AUTO_RELOAD;DB2_4K_DEVICE_SUPPORT=ON;DB2_FMP_RUN_AS_CONNECTED_USER=NO;DB2_WORKLOAD=ANALYTICS'</code></p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>'DB2_INSTANCE_REGISTRY'</code></li>
<li>Default: None</li>
</ul>
<h2 id="role-variables-mpp-system">Role Variables - MPP System<a class="headerlink" href="#role-variables-mpp-system" title="Permanent link"></a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not use these variables if you intend to use the Db2 instance with IBM Maximo Application Suite; no MAS application supports Db2 MPP</p>
</div>
<h3 id="db2_mln_count">db2_mln_count<a class="headerlink" href="#db2_mln_count" title="Permanent link"></a></h3>
<p>The number of logical nodes (i.e. database partitions to create). Note: ensure that the application using this Db2 can support Db2 MPP (which is created when <code>DB2_MLN_COUNT</code> is greater than 1).</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>'DB2_MLN_COUNT</code></li>
<li>Default: 1</li>
</ul>
<h3 id="db2_num_pods">db2_num_pods<a class="headerlink" href="#db2_num_pods" title="Permanent link"></a></h3>
<p>The number of Db2 pods to create in the instance. Note that <code>db2_num_pods</code> must be less than or equal to <code>db2_mln_count</code>.  A single db2u pod can contain multiple logical nodes. So be sure to avoid specifying a large number for <code>db2_mln_count</code> while specifying a small number for <code>db2_num_pods</code>. If in doubt, make <code>db2_mln_count = db2_num_pods</code>. For more information refer to the <a href="https://www.ibm.com/docs/en/db2-warehouse?topic=SSCJDQ/com.ibm.swg.im.dashdb.ucontainer.doc/doc/db2w-mempernode-new.html">Db2 documentation</a>.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>'DB2_NUM_PODS</code></li>
<li>Default: 1</li>
</ul>
<h2 id="role-variables-mas-configuration">Role Variables - MAS Configuration<a class="headerlink" href="#role-variables-mas-configuration" title="Permanent link"></a></h2>
<h3 id="mas_instance_id">mas_instance_id<a class="headerlink" href="#mas_instance_id" title="Permanent link"></a></h3>
<p>Providing this and <code>mas_config_dir</code> will instruct the role to generate a JdbcCfg template that can be used to configure MAS to connect to this database.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>MAS_INSTANCE_ID</code></li>
<li>Default: None</li>
</ul>
<h3 id="mas_config_dir">mas_config_dir<a class="headerlink" href="#mas_config_dir" title="Permanent link"></a></h3>
<p>Providing this and <code>mas_instance_id</code> will instruct the role to generate a JdbcCfg template that can be used to configure MAS to connect to this database.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>MAS_CONFIG_DIR</code></li>
<li>Default: None</li>
</ul>
<h3 id="mas_config_scope">mas_config_scope<a class="headerlink" href="#mas_config_scope" title="Permanent link"></a></h3>
<p>Supported values are <code>system</code>, <code>ws</code>, <code>app</code>, or <code>wsapp</code>, this is only used when both <code>mas_config_dir</code> and <code>mas_instance_id</code> are set.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>MAS_CONFIG_SCOPE</code></li>
<li>Default: <code>system</code></li>
</ul>
<h3 id="mas_workspace_id">mas_workspace_id<a class="headerlink" href="#mas_workspace_id" title="Permanent link"></a></h3>
<p>This is only used when both <code>mas_config_dir</code> and <code>mas_instance_id</code> are set, and <code>mas_config_scope</code> is set to either <code>ws</code> or <code>wsapp</code></p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>MAS_WORKSPACE_ID</code></li>
<li>Default: None</li>
</ul>
<h3 id="mas_application_id">mas_application_id<a class="headerlink" href="#mas_application_id" title="Permanent link"></a></h3>
<p>This is only used when both <code>mas_config_dir</code> and <code>mas_instance_id</code> are set, and <code>mas_config_scope</code> is set to either <code>app</code> or <code>wsapp</code></p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>'MAS_APP_ID</code></li>
<li>Default: None</li>
</ul>
<h2 id="example-playbook">Example Playbook<a class="headerlink" href="#example-playbook" title="Permanent link"></a></h2>
<pre><code class="language-yaml">- hosts: localhost
  any_errors_fatal: true
  vars:
    ibm_entitlement_key: xxxxx

    # Configuration for the Db2 cluster
    db2_version: 11.5.7.0-cn2
    db2_instance_name: db2u-db01
    db2_dbname: BLUDB

    db2_meta_storage_class: &quot;ibmc-file-gold&quot;
    db2_data_storage_class: &quot;ibmc-block-gold&quot;
    db2_backup_storage_class: &quot;ibmc-file-gold&quot;
    db2_logs_storage_class: &quot;ibmc-block-gold&quot;
    db2_temp_storage_class: &quot;ibmc-block-gold&quot;

    # Create the MAS JdbcCfg &amp; Secret resource definitions
    mas_instance_id: inst1
    mas_config_dir: /home/david/masconfig
  roles:
    - ibm.mas_devops.db2
</code></pre>
<h2 id="license">License<a class="headerlink" href="#license" title="Permanent link"></a></h2>
<p>EPL-2.0</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/ibm-mas/ansible-devops" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../cp4d_upgrade/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../db2_backup/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
